import sys
import subprocess

params = sys.argv
if len(params) < 10:
    exit('Введите все данные')
id = str(params[1])
autorun = str(params[2])
scrit = str(params[3])
exe = str(params[4])
run = str(params[5])
pyw = str(params[6])
sis = str(params[7])
otobr = str(params[8])
path = str(params[9])

print('[log] > Данные получены')

if len(params)>9:
    mn =[]
    path = ''
    for c in params[9:len(params)]:
        mn.append(c)
    for l in mn:
        path = path + l + ' '


def tr_fa(id,path,autorun,scrit,exe,run,pyw, sis, otobr):
    
    if 'http' in id:
        if 'view?' in id.split('/')[5]:
            id = id.split('/')[6]
        else:
            id = id.split('/')[5]
    if '\\' in path:
        l = len(path.split('\\'))
        nazvanie = path.split('\\')[l-1]
    elif '\\' not in path:
        nazvanie = path
    elif 'C:' in path:
        if '\\' in path:
            c = '\\'
        else:
            c = "\\"
        m = len(path.split(c))
        nazvanie = path.split(c)[m-1]
    if autorun == '0':
        autorun = 'False'
    elif autorun == '1':
        autorun = 'True'
    
    if scrit == '0':
        scrit = 'False'
    elif scrit == '1':
        scrit = 'True' 

    if exe == '0':
        exe = 'False'
    elif exe == '1':
        exe = 'True'
    
    if run == '0':
        run = 'False'
    elif run =='1':
        run ='True'
    
    if pyw == '0':
        rashirenie = '.py'
    elif pyw == '1':
        rashirenie = '.pyw'
    
    if sis == '0':
        sis = 'False'
    elif sis == '1':
        sis = 'True'
    
    if otobr == '0':
        otobr = 'False'
    elif otobr =='1':
        otobr = 'True' 

    return id, path, autorun, scrit, exe, run, pyw,nazvanie,rashirenie,sis,otobr


id, path, autorun, scrit, exe, run, pyw, nazvanie, rashirenie,sis,otobr = tr_fa(id,path,autorun,scrit,exe,run,pyw,sis,otobr)

print('[log] > Данные обробатаны')

site = 'https://drive.google.com/uc?export=download&id=' + str(id)
print('[log] > Сгенерирована ссылка для скачивания')

nachalo='site = "'+str(site) +'"\npath = "' + str(path) +'"\nautorun=' +autorun+'\nscrit='+scrit+'\nrun='+run+'\nnazvanie="'+str(nazvanie)+'"\nsis = ' + sis+'\notobr='+otobr

f = open('script.py', 'r')
fr = f.readlines()
f.close()
text = ''
for t in fr:
    text = text + t
new_text = nachalo + '\n\n' + text
print('[log] > Python код сгенерирован')

file_name = 'enter_file' + rashirenie
f = open(file_name, 'w')
f.write(new_text)
f.close()
print('[log] > Python файл называется ' + file_name)
if exe == 'True':
    print('[log] > Идет компиляция файла')
    command = 'pyinstaller --onefile ' + file_name
    subprocess.getoutput(command)
    print('[log] > Exe файл создан, он находиться по пути \\dist\\enter_file.exe')




            









